<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Gen (qcheck-core.QCheck2.Gen)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">qcheck-core</a> &#x00BB; <a href="../index.html">QCheck2</a> &#x00BB; Gen</nav><h1>Module <code>QCheck2.Gen</code></h1><p>A generator is responsible for generating pseudo-random values and provide shrinks (smaller values) when a test fails.</p><nav class="toc"><ul><li><a href="#primitive_generators">Primitive generators</a></li><li><a href="#ranges">Ranges</a></li><li><a href="#choosing-elements">Choosing elements</a></li><li><a href="#shuffling-elements">Shuffling elements</a></li><li><a href="#corner-cases">Corner cases</a></li><li><a href="#lists,-arrays-and-options">Lists, arrays and options</a></li><li><a href="#combining-generators">Combining generators</a></li><li><a href="#convert-a-structure-of-generator-to-a-generator-of-structure">Convert a structure of generator to a generator of structure</a></li><li><a href="#influencing-the-size-of-generated-values">Influencing the size of generated values</a></li><li><a href="#recursive-data-structures">Recursive data structures</a></li><li><a href="#composing_generators">Composing generators</a><ul><li><a href="#functor">Functor</a></li><li><a href="#applicative">Applicative</a></li><li><a href="#monad">Monad</a></li></ul></li><li><a href="#debug-generators">Debug generators</a></li></ul></nav></header><aside><p>This module provides some of the most important features of QCheck:</p><ul><li><a href="index.html#primitive_generators"><span>primitive generators</span></a></li><li><a href="index.html#composing_generators"><span>generator compositions</span></a></li></ul></aside><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> <span>'a t</span></code></dt><dd><p>A random generator for values of type <code>'a</code>.</p></dd></dl><dl><dt class="spec type" id="type-sized"><a href="#type-sized" class="anchor"></a><code><span class="keyword">type</span> <span>'a sized</span></code><code> = int <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Random generator with a size bound.</p></dd></dl><section><header><h4 id="primitive_generators"><a href="#primitive_generators" class="anchor"></a>Primitive generators</h4></header><dl><dt class="spec value" id="val-unit"><a href="#val-unit" class="anchor"></a><code><span class="keyword">val</span> unit : <span>unit <a href="index.html#type-t">t</a></span></code></dt><dd><p>The unit generator.</p><p>Does not shrink.</p></dd></dl><dl><dt class="spec value" id="val-bool"><a href="#val-bool" class="anchor"></a><code><span class="keyword">val</span> bool : <span>bool <a href="index.html#type-t">t</a></span></code></dt><dd><p>The boolean generator.</p><p>Shrinks towards <code>false</code>.</p></dd></dl><dl><dt class="spec value" id="val-int"><a href="#val-int" class="anchor"></a><code><span class="keyword">val</span> int : <span>int <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generates integers uniformly.</p><p>Shrinks towards <code>0</code>.</p></dd></dl><dl><dt class="spec value" id="val-pint"><a href="#val-pint" class="anchor"></a><code><span class="keyword">val</span> pint : <span>?&#8288;origin:int</span> <span>&#45;&gt;</span> <span>int <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generates non-strictly positive integers uniformly (<code>0</code> included).</p><p>Shrinks towards <code>origin</code> if specified, otherwise towards <code>0</code>.</p></dd></dl><dl><dt class="spec value" id="val-small_nat"><a href="#val-small_nat" class="anchor"></a><code><span class="keyword">val</span> small_nat : <span>int <a href="index.html#type-t">t</a></span></code></dt><dd><p>Small positive integers (&lt; <code>100</code>, <code>0</code> included).</p><p>Non-uniform: smaller numbers are more likely than bigger numbers.</p><p>Shrinks towards <code>0</code>.</p><dl><dt>since</dt><dd>0.5.1</dd></dl></dd></dl><dl><dt class="spec value" id="val-nat"><a href="#val-nat" class="anchor"></a><code><span class="keyword">val</span> nat : <span>int <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generates natural numbers (&lt; <code>10_000</code>).</p><p>Non-uniform: smaller numbers are more likely than bigger numbers.</p><p>Shrinks towards <code>0</code>.</p></dd></dl><dl><dt class="spec value" id="val-big_nat"><a href="#val-big_nat" class="anchor"></a><code><span class="keyword">val</span> big_nat : <span>int <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generates natural numbers, possibly large (&lt; <code>1_000_000</code>).</p><p>Non-uniform: smaller numbers are more likely than bigger numbers.</p><p>Shrinks towards <code>0</code>.</p><dl><dt>since</dt><dd>0.10</dd></dl></dd></dl><dl><dt class="spec value" id="val-neg_int"><a href="#val-neg_int" class="anchor"></a><code><span class="keyword">val</span> neg_int : <span>int <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generates non-strictly negative integers (<code>0</code> included).</p><p>Non-uniform: smaller numbers (in absolute value) are more likely than bigger numbers.</p><p>Shrinks towards <code>0</code>.</p></dd></dl><dl><dt class="spec value" id="val-small_int"><a href="#val-small_int" class="anchor"></a><code><span class="keyword">val</span> small_int : <span>int <a href="index.html#type-t">t</a></span></code></dt><dd><p>Small UNSIGNED integers, for retrocompatibility.</p><p>Shrinks towards <code>0</code>.</p><dl><dt>deprecated</dt><dd><p>use <a href="index.html#val-small_nat"><code>small_nat</code></a>.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-small_signed_int"><a href="#val-small_signed_int" class="anchor"></a><code><span class="keyword">val</span> small_signed_int : <span>int <a href="index.html#type-t">t</a></span></code></dt><dd><p>Small SIGNED integers, based on <a href="index.html#val-small_nat"><code>small_nat</code></a>.</p><p>Non-uniform: smaller numbers (in absolute value) are more likely than bigger numbers.</p><p>Shrinks towards <code>0</code>.</p><dl><dt>since</dt><dd>0.5.2</dd></dl></dd></dl><dl><dt class="spec value" id="val-small_int_corners"><a href="#val-small_int_corners" class="anchor"></a><code><span class="keyword">val</span> small_int_corners : unit <span>&#45;&gt;</span> <span>int <a href="index.html#type-t">t</a></span></code></dt><dd><p>As <a href="index.html#val-small_int"><code>small_int</code></a>, but each newly created generator starts with a list of corner cases before falling back on random generation.</p></dd></dl><dl><dt class="spec value" id="val-int32"><a href="#val-int32" class="anchor"></a><code><span class="keyword">val</span> int32 : <span>int32 <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generates uniform <a href="index.html#val-int32"><code>int32</code></a> values.</p><p>Shrinks towards <code>0l</code>.</p></dd></dl><dl><dt class="spec value" id="val-ui32"><a href="#val-ui32" class="anchor"></a><code><span class="keyword">val</span> ui32 : <span>int32 <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generates <a href="index.html#val-int32"><code>int32</code></a> values.</p><p>Shrinks towards <code>0l</code>.</p><dl><dt>deprecated</dt><dd><p>use <a href="index.html#val-int32"><code>int32</code></a> instead, the name is wrong, values <i>are</i> signed.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-int64"><a href="#val-int64" class="anchor"></a><code><span class="keyword">val</span> int64 : <span>int64 <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generates uniform <a href="index.html#val-int64"><code>int64</code></a> values.</p><p>Shrinks towards <code>0L</code>.</p></dd></dl><dl><dt class="spec value" id="val-ui64"><a href="#val-ui64" class="anchor"></a><code><span class="keyword">val</span> ui64 : <span>int64 <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generates <a href="index.html#val-int64"><code>int64</code></a> values.</p><p>Shrinks towards <code>0L</code>.</p><dl><dt>deprecated</dt><dd><p>use <a href="index.html#val-int64"><code>int64</code></a> instead, the name is wrong, values <i>are</i> signed.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-float"><a href="#val-float" class="anchor"></a><code><span class="keyword">val</span> float : <span>float <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generates floating point numbers.</p><p>Shrinks towards <code>0.</code>.</p></dd></dl><dl><dt class="spec value" id="val-pfloat"><a href="#val-pfloat" class="anchor"></a><code><span class="keyword">val</span> pfloat : <span>float <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generates positive floating point numbers (<code>0.</code> included).</p><p>Shrinks towards <code>0.</code>.</p></dd></dl><dl><dt class="spec value" id="val-nfloat"><a href="#val-nfloat" class="anchor"></a><code><span class="keyword">val</span> nfloat : <span>float <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generates negative floating point numbers. (<code>-0.</code> included).</p><p>Shrinks towards <code>-0.</code>.</p></dd></dl><dl><dt class="spec value" id="val-char"><a href="#val-char" class="anchor"></a><code><span class="keyword">val</span> char : <span>char <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generates characters in the <code>0..255</code> range.</p><p>Shrinks towards <code>'a'</code>.</p></dd></dl><dl><dt class="spec value" id="val-printable"><a href="#val-printable" class="anchor"></a><code><span class="keyword">val</span> printable : <span>char <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generates printable characters.</p><p>The exhaustive list of character codes is:</p><ul><li><code>32</code> to <code>126</code>, inclusive</li><li><code>'\n'</code></li></ul><p>Shrinks towards <code>'a'</code>.</p></dd></dl><dl><dt class="spec value" id="val-numeral"><a href="#val-numeral" class="anchor"></a><code><span class="keyword">val</span> numeral : <span>char <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generates numeral characters <code>'0'..'9'</code>.</p><p>Shrinks towards <code>'0'</code>.</p></dd></dl><dl><dt class="spec value" id="val-string_size"><a href="#val-string_size" class="anchor"></a><code><span class="keyword">val</span> string_size : <span>?&#8288;gen:<span>char <a href="index.html#type-t">t</a></span></span> <span>&#45;&gt;</span> <span>int <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span>string <a href="index.html#type-t">t</a></span></code></dt><dd><p>Builds a string generator from a (non-negative) size generator. Accepts an optional character generator (the default is <a href="index.html#val-char"><code>char</code></a>).</p><p>Shrinks on the number of characters first, then on the characters.</p></dd></dl><dl><dt class="spec value" id="val-string"><a href="#val-string" class="anchor"></a><code><span class="keyword">val</span> string : <span>string <a href="index.html#type-t">t</a></span></code></dt><dd><p>Builds a string generator. String size is generated by <a href="index.html#val-nat"><code>nat</code></a>. The default character generator is <a href="index.html#val-char"><code>char</code></a>. See also <a href="index.html#val-string_of"><code>string_of</code></a> and <a href="index.html#val-string_printable"><code>string_printable</code></a> for versions with custom char generator.</p><p>Shrinks on the number of characters first, then on the characters.</p></dd></dl><dl><dt class="spec value" id="val-string_of"><a href="#val-string_of" class="anchor"></a><code><span class="keyword">val</span> string_of : <span>char <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span>string <a href="index.html#type-t">t</a></span></code></dt><dd><p>Builds a string generator using the given character generator.</p><p>Shrinks on the number of characters first, then on the characters.</p><dl><dt>since</dt><dd>0.11</dd></dl></dd></dl><dl><dt class="spec value" id="val-string_printable"><a href="#val-string_printable" class="anchor"></a><code><span class="keyword">val</span> string_printable : <span>string <a href="index.html#type-t">t</a></span></code></dt><dd><p>Builds a string generator using the <a href="index.html#val-printable"><code>printable</code></a> character generator.</p><p>Shrinks on the number of characters first, then on the characters.</p><dl><dt>since</dt><dd>0.11</dd></dl></dd></dl><dl><dt class="spec value" id="val-small_string"><a href="#val-small_string" class="anchor"></a><code><span class="keyword">val</span> small_string : <span>?&#8288;gen:<span>char <a href="index.html#type-t">t</a></span></span> <span>&#45;&gt;</span> <span>string <a href="index.html#type-t">t</a></span></code></dt><dd><p>Builds a string generator, length is <a href="index.html#val-small_nat"><code>small_nat</code></a>. Accepts an optional character generator (the default is <a href="index.html#val-char"><code>char</code></a>).</p><p>Shrinks on the number of characters first, then on the characters.</p></dd></dl><dl><dt class="spec value" id="val-pure"><a href="#val-pure" class="anchor"></a><code><span class="keyword">val</span> pure : <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>pure a</code> creates a generator that always returns <code>a</code>.</p><p>Does not shrink.</p><dl><dt>since</dt><dd>0.8</dd></dl></dd></dl><dl><dt class="spec value" id="val-return"><a href="#val-return" class="anchor"></a><code><span class="keyword">val</span> return : <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Synonym for <a href="index.html#val-pure"><code>pure</code></a></p></dd></dl><dl><dt class="spec value" id="val-make_primitive"><a href="#val-make_primitive" class="anchor"></a><code><span class="keyword">val</span> make_primitive : <span>gen:<span>(Stdlib.Random.State.t <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span></span> <span>&#45;&gt;</span> <span>shrink:<span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> Stdlib.Seq.t</span>)</span></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>make_primitive ~gen ~shrink</code> creates a generator from a function <code>gen</code> that creates a random value (this function must only use the given <span class="xref-unresolved" title="unresolved reference to &quot;Random.State.t&quot;"><span class="xref-unresolved" title="unresolved reference to &quot;Random.State&quot;"><code>Random</code>.State</span>.t</span> for randomness) and a function <code>shrink</code> that, given a value <code>a</code>, returns a lazy list of &quot;smaller&quot; values (used when a test fails).</p><p>This lower-level function is meant to build generators for &quot;primitive&quot; types that can neither be built with other primitive generators nor through composition, or to have more control on the shrinking steps.</p><p><code>shrink</code> must obey the following rules (for your own definition of &quot;small&quot;):</p><ul><li><code>shrink a = Seq.empty</code> when <code>a</code> is the smallest possible value</li><li><code>shrink a</code> must return values strictly smaller than <code>a</code>, ideally from smallest to largest (for faster shrinking)</li><li><code>let rec loop a = match shrink a () with | Nil -&gt; () | Cons (smaller_a, _) -&gt; loop smaller_a</code> must end for all values <code>a</code> of type <code>'a</code> (i.e. there must not be an infinite number of shrinking steps).</li></ul><p>⚠️ This is an unstable API as it partially exposes the implementation. In particular, the type of <code>Random.State.t</code> may very well change in a future version, e.g. if QCheck switches to another randomness library.</p></dd></dl><dl><dt class="spec value" id="val-add_shrink_invariant"><a href="#val-add_shrink_invariant" class="anchor"></a><code><span class="keyword">val</span> add_shrink_invariant : <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> bool)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>add_shrink_invariant f gen</code> returns a generator similar to <code>gen</code> except all shrinks satisfy <code>f</code>. This way it's easy to preserve invariants that are enforced by generators, when shrinking values</p><dl><dt>since</dt><dd>0.8</dd></dl><dl><dt>deprecated</dt><dd><p>is this function still useful? I feel like it is either useless (invariants should already be part of the shrinking logic, not be added later) or a special, incomplete case of <a href="index.html#type-t"><code>Gen.t</code></a> being an Alternative (not implemented yet). For now we keep it and wait for users feedback (hence deprecation to raise attention).</p></dd></dl></dd></dl></section><section><header><h4 id="ranges"><a href="#ranges" class="anchor"></a>Ranges</h4></header><dl><dt class="spec value" id="val-int_bound"><a href="#val-int_bound" class="anchor"></a><code><span class="keyword">val</span> int_bound : int <span>&#45;&gt;</span> <span>int <a href="index.html#type-t">t</a></span></code></dt><dd><p>Uniform integer generator producing integers within <code>0..bound</code>.</p><p>Shrinks towards <code>0</code>.</p><dl><dt>raises Invalid_argument</dt><dd><p>if the argument is negative.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-int_range"><a href="#val-int_range" class="anchor"></a><code><span class="keyword">val</span> int_range : <span>?&#8288;origin:int</span> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span>int <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>int_range ?origin low high</code> is an uniform integer generator producing integers within <code>low..high</code> (inclusive).</p><p>Shrinks towards <code>origin</code> if specified, otherwise towards <code>0</code> (but always stays within the range).</p><p>Examples:</p><ul><li><code>int_range ~origin:6 (-5) 15</code> will shrink towards <code>6</code></li><li><code>int_range (-5) 15</code> will shrink towards <code>0</code></li><li><code>int_range 8 20</code> will shrink towards <code>8</code> (closest to <code>0</code> within range)</li><li><code>int_range (-20) (-8)</code> will shrink towards <code>-8</code> (closest to <code>0</code> within range)</li></ul><dl><dt>raises Invalid_argument</dt><dd><p>if any of the following holds:</p><ul><li><code>low &gt; high</code></li><li><code>origin &lt; low</code></li><li><code>origin &gt; high</code></li></ul></dd></dl></dd></dl><dl><dt class="spec value" id="val-(--)"><a href="#val-(--)" class="anchor"></a><code><span class="keyword">val</span> (--) : int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span>int <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>a -- b</code> is an alias for <code>int_range a b</code>. See <a href="index.html#val-int_range"><code>int_range</code></a> for more information.</p></dd></dl><dl><dt class="spec value" id="val-float_bound_inclusive"><a href="#val-float_bound_inclusive" class="anchor"></a><code><span class="keyword">val</span> float_bound_inclusive : <span>?&#8288;origin:float</span> <span>&#45;&gt;</span> float <span>&#45;&gt;</span> <span>float <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>float_bound_inclusive ?origin bound</code> returns a random floating-point number between <code>0.</code> and <code>bound</code> (inclusive). If <code>bound</code> is negative, the result is negative or zero. If <code>bound</code> is <code>0.</code>, the result is <code>0.</code>.</p><p>Shrinks towards <code>origin</code> if given, otherwise towards <code>0.</code>.</p><dl><dt>since</dt><dd>0.11</dd></dl></dd></dl><dl><dt class="spec value" id="val-float_bound_exclusive"><a href="#val-float_bound_exclusive" class="anchor"></a><code><span class="keyword">val</span> float_bound_exclusive : <span>?&#8288;origin:float</span> <span>&#45;&gt;</span> float <span>&#45;&gt;</span> <span>float <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>float_bound_exclusive origin bound</code> returns a random floating-point number between <code>0.</code> and <code>bound</code> (exclusive). If <code>bound</code> is negative, the result is negative or zero.</p><p>Shrinks towards <code>origin</code> if given, otherwise towards <code>0.</code>.</p><dl><dt>raises Invalid_argument</dt><dd><p>if <code>bound</code> is <code>0.</code>.</p></dd></dl><dl><dt>since</dt><dd>0.11</dd></dl></dd></dl><dl><dt class="spec value" id="val-float_range"><a href="#val-float_range" class="anchor"></a><code><span class="keyword">val</span> float_range : <span>?&#8288;origin:float</span> <span>&#45;&gt;</span> float <span>&#45;&gt;</span> float <span>&#45;&gt;</span> <span>float <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>float_range ?origin low high</code> generates floating-point numbers within <code>low</code> and <code>high</code> (inclusive).</p><p>Shrinks towards <code>origin</code> if specified, otherwise towards <code>0.</code> (but always stays within the range).</p><p>Examples:</p><ul><li><code>float_range ~origin:6.2 (-5.8) 15.1</code> will shrink towards <code>6.2</code></li><li><code>float_range (-5.8) 15.1</code> will shrink towards <code>0.</code></li><li><code>float_range 8.5 20.1</code> will shrink towards <code>8.5</code> (closest to <code>0.</code> within range)</li><li><code>float_range (-20.1) (-8.5)</code> will shrink towards <code>-8.5</code> (closest to <code>0.</code> within range)</li></ul><dl><dt>raises Invalid_argument</dt><dd><p>if any of the following holds:</p><ul><li><code>low &gt; high</code></li><li><code>high -. low &gt; max_float</code></li><li><code>origin &lt; low</code></li><li><code>origin &gt; high</code></li></ul></dd></dl><dl><dt>since</dt><dd>0.11</dd></dl></dd></dl><dl><dt class="spec value" id="val-(--.)"><a href="#val-(--.)" class="anchor"></a><code><span class="keyword">val</span> (--.) : float <span>&#45;&gt;</span> float <span>&#45;&gt;</span> <span>float <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>a --. b</code> is an alias for <code>float_range ~origin:a a b</code>. See <a href="index.html#val-float_range"><code>float_range</code></a> for more information.</p><dl><dt>since</dt><dd>0.11</dd></dl></dd></dl><dl><dt class="spec value" id="val-char_range"><a href="#val-char_range" class="anchor"></a><code><span class="keyword">val</span> char_range : <span>?&#8288;origin:char</span> <span>&#45;&gt;</span> char <span>&#45;&gt;</span> char <span>&#45;&gt;</span> <span>char <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>char_range ?origin low high</code> generates chars between <code>low</code> and <code>high</code>, inclusive. Example: <code>char_range 'a' 'z'</code> for all lower case ASCII letters.</p><p>Shrinks towards <code>origin</code> if specified, otherwise towards <code>low</code>.</p><dl><dt>raises Invalid_argument</dt><dd><p>if <code>low &gt; high</code>.</p></dd></dl><dl><dt>since</dt><dd>0.13</dd></dl></dd></dl></section><section><header><h4 id="choosing-elements"><a href="#choosing-elements" class="anchor"></a>Choosing elements</h4></header><dl><dt class="spec value" id="val-oneof"><a href="#val-oneof" class="anchor"></a><code><span class="keyword">val</span> oneof : <span><span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> list</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>oneof l</code> constructs a generator that selects among the given list of generators <code>l</code>.</p><p>Shrinks towards the first generator of the list.</p><dl><dt>raises Invalid_argument</dt><dd><p>or Failure if <code>l</code> is empty</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-oneofl"><a href="#val-oneofl" class="anchor"></a><code><span class="keyword">val</span> oneofl : <span><span class="type-var">'a</span> list</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>oneofl l</code> constructs a generator that selects among the given list of values <code>l</code>.</p><p>Shrinks towards the first element of the list.</p><dl><dt>raises Invalid_argument</dt><dd><p>or Failure if <code>l</code> is empty</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-oneofa"><a href="#val-oneofa" class="anchor"></a><code><span class="keyword">val</span> oneofa : <span><span class="type-var">'a</span> array</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>oneofa a</code> constructs a generator that selects among the given array of values <code>a</code>.</p><p>Shrinks towards the first element of the array.</p><dl><dt>raises Invalid_argument</dt><dd><p>or Failure if <code>l</code> is empty</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-frequency"><a href="#val-frequency" class="anchor"></a><code><span class="keyword">val</span> frequency : <span><span>(int * <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span>)</span> list</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Constructs a generator that selects among a given list of generators. Each of the given generators are chosen based on a positive integer weight.</p><p>Shrinks towards the first element of the list.</p></dd></dl><dl><dt class="spec value" id="val-frequencyl"><a href="#val-frequencyl" class="anchor"></a><code><span class="keyword">val</span> frequencyl : <span><span>(int * <span class="type-var">'a</span>)</span> list</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Constructs a generator that selects among a given list of values. Each of the given values are chosen based on a positive integer weight.</p><p>Shrinks towards the first element of the list.</p></dd></dl><dl><dt class="spec value" id="val-frequencya"><a href="#val-frequencya" class="anchor"></a><code><span class="keyword">val</span> frequencya : <span><span>(int * <span class="type-var">'a</span>)</span> array</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Constructs a generator that selects among a given array of values. Each of the array entries are chosen based on a positive integer weight.</p><p>Shrinks towards the first element of the array.</p></dd></dl></section><section><header><h4 id="shuffling-elements"><a href="#shuffling-elements" class="anchor"></a>Shuffling elements</h4></header><dl><dt class="spec value" id="val-shuffle_a"><a href="#val-shuffle_a" class="anchor"></a><code><span class="keyword">val</span> shuffle_a : <span><span class="type-var">'a</span> array</span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> array</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Returns a copy of the array with its elements shuffled.</p></dd></dl><dl><dt class="spec value" id="val-shuffle_l"><a href="#val-shuffle_l" class="anchor"></a><code><span class="keyword">val</span> shuffle_l : <span><span class="type-var">'a</span> list</span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> list</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Creates a generator of shuffled lists.</p></dd></dl><dl><dt class="spec value" id="val-shuffle_w_l"><a href="#val-shuffle_w_l" class="anchor"></a><code><span class="keyword">val</span> shuffle_w_l : <span><span>(int * <span class="type-var">'a</span>)</span> list</span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> list</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Creates a generator of weighted shuffled lists. A given list is shuffled on each generation according to the weights of its elements. An element with a larger weight is more likely to be at the front of the list than an element with a smaller weight. If we want to pick random elements from the (head of) list but need to prioritize some elements over others, this generator can be useful.</p><p>Example: given a weighted list <code>[1, &quot;one&quot;; 5, &quot;five&quot;; 10, &quot;ten&quot;]</code>, the generator is more likely to generate <code>[&quot;ten&quot;; &quot;five&quot;; &quot;one&quot;]</code> or <code>[&quot;five&quot;; &quot;ten&quot;; &quot;one&quot;]</code> than <code>[&quot;one&quot;; &quot;ten&quot;; &quot;five&quot;]</code> because &quot;ten&quot; and &quot;five&quot; have larger weights than &quot;one&quot;.</p><dl><dt>since</dt><dd>0.11</dd></dl></dd></dl></section><section><header><h4 id="corner-cases"><a href="#corner-cases" class="anchor"></a>Corner cases</h4></header><dl><dt class="spec value" id="val-graft_corners"><a href="#val-graft_corners" class="anchor"></a><code><span class="keyword">val</span> graft_corners : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> list</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>graft_corners gen l ()</code> makes a new generator that enumerates the corner cases in <code>l</code> and then behaves like <code>g</code>.</p><p>Does not shrink if the test fails on a grafted value. Shrinks towards <code>gen</code> otherwise.</p><dl><dt>since</dt><dd>0.6</dd></dl></dd></dl><dl><dt class="spec value" id="val-int_pos_corners"><a href="#val-int_pos_corners" class="anchor"></a><code><span class="keyword">val</span> int_pos_corners : <span>int list</span></code></dt><dd><p>Non-negative corner cases for int.</p><dl><dt>since</dt><dd>0.6</dd></dl></dd></dl><dl><dt class="spec value" id="val-int_corners"><a href="#val-int_corners" class="anchor"></a><code><span class="keyword">val</span> int_corners : <span>int list</span></code></dt><dd><p>All corner cases for int.</p><dl><dt>since</dt><dd>0.6</dd></dl></dd></dl></section><section><header><h4 id="lists,-arrays-and-options"><a href="#lists,-arrays-and-options" class="anchor"></a>Lists, arrays and options</h4></header><dl><dt class="spec value" id="val-list"><a href="#val-list" class="anchor"></a><code><span class="keyword">val</span> list : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> list</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Builds a list generator from an element generator. List size is generated by <a href="index.html#val-nat"><code>nat</code></a>.</p><p>Shrinks on the number of elements first, then on elements.</p></dd></dl><dl><dt class="spec value" id="val-small_list"><a href="#val-small_list" class="anchor"></a><code><span class="keyword">val</span> small_list : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> list</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generates lists of small size (see <a href="index.html#val-small_nat"><code>small_nat</code></a>).</p><p>Shrinks on the number of elements first, then on elements.</p><dl><dt>since</dt><dd>0.5.3</dd></dl></dd></dl><dl><dt class="spec value" id="val-list_size"><a href="#val-list_size" class="anchor"></a><code><span class="keyword">val</span> list_size : <span>int <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> list</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Builds a list generator from a (non-negative) size generator and an element generator.</p><p>Shrinks on the number of elements first, then on elements.</p></dd></dl><dl><dt class="spec value" id="val-list_repeat"><a href="#val-list_repeat" class="anchor"></a><code><span class="keyword">val</span> list_repeat : int <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> list</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>list_repeat i g</code> builds a list generator from exactly <code>i</code> elements generated by <code>g</code>.</p><p>Shrinks on elements only.</p></dd></dl><dl><dt class="spec value" id="val-array"><a href="#val-array" class="anchor"></a><code><span class="keyword">val</span> array : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> array</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Builds an array generator from an element generator. Array size is generated by <a href="index.html#val-nat"><code>nat</code></a>.</p><p>Shrinks on the number of elements first, then on elements.</p></dd></dl><dl><dt class="spec value" id="val-array_size"><a href="#val-array_size" class="anchor"></a><code><span class="keyword">val</span> array_size : <span>int <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> array</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Builds an array generator from a (non-negative) size generator and an element generator.</p><p>Shrinks on the number of elements first, then on elements.</p></dd></dl><dl><dt class="spec value" id="val-small_array"><a href="#val-small_array" class="anchor"></a><code><span class="keyword">val</span> small_array : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> array</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generates arrays of small size (see <a href="index.html#val-small_nat"><code>small_nat</code></a>).</p><p>Shrinks on the number of elements first, then on elements.</p><dl><dt>since</dt><dd>0.10</dd></dl></dd></dl><dl><dt class="spec value" id="val-array_repeat"><a href="#val-array_repeat" class="anchor"></a><code><span class="keyword">val</span> array_repeat : int <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> array</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>array_repeat i g</code> builds an array generator from exactly <code>i</code> elements generated by <code>g</code>.</p><p>Shrinks on elements only.</p></dd></dl><dl><dt class="spec value" id="val-opt"><a href="#val-opt" class="anchor"></a><code><span class="keyword">val</span> opt : <span>?&#8288;ratio:float</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> option</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>opt gen</code> is an <code>option</code> generator that uses <code>gen</code> when generating <code>Some</code> values.</p><p>Shrinks towards <code>None</code> then towards shrinks of <code>gen</code>.</p><dl><dt>parameter ratio</dt><dd><p>a float between <code>0.</code> and <code>1.</code> indicating the probability of a sample to be <code>Some _</code> rather than <code>None</code> (value is <code>0.85</code>).</p></dd></dl></dd></dl></section><section><header><h4 id="combining-generators"><a href="#combining-generators" class="anchor"></a>Combining generators</h4></header><dl><dt class="spec value" id="val-pair"><a href="#val-pair" class="anchor"></a><code><span class="keyword">val</span> pair : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span>)</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>pair gen1 gen2</code> generates pairs.</p><p>Shrinks on <code>gen1</code> and then <code>gen2</code>.</p></dd></dl><dl><dt class="spec value" id="val-triple"><a href="#val-triple" class="anchor"></a><code><span class="keyword">val</span> triple : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'c</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span>)</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>triple gen1 gen2 gen3</code> generates triples.</p><p>Shrinks on <code>gen1</code>, then <code>gen2</code> and then <code>gen3</code>.</p></dd></dl><dl><dt class="spec value" id="val-quad"><a href="#val-quad" class="anchor"></a><code><span class="keyword">val</span> quad : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'c</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'d</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span> * <span class="type-var">'d</span>)</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>quad gen1 gen2 gen3 gen4</code> generates quadruples.</p><p>Shrinks on <code>gen1</code>, then <code>gen2</code>, then <code>gen3</code> and then <code>gen4</code>.</p><dl><dt>since</dt><dd>0.5.1</dd></dl></dd></dl></section><section><header><h4 id="convert-a-structure-of-generator-to-a-generator-of-structure"><a href="#convert-a-structure-of-generator-to-a-generator-of-structure" class="anchor"></a>Convert a structure of generator to a generator of structure</h4></header><dl><dt class="spec value" id="val-flatten_l"><a href="#val-flatten_l" class="anchor"></a><code><span class="keyword">val</span> flatten_l : <span><span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> list</span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> list</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generate a list of elements from individual generators.</p><p>Shrinks on the elements of the list, in the list order.</p><dl><dt>since</dt><dd>0.13</dd></dl></dd></dl><dl><dt class="spec value" id="val-flatten_a"><a href="#val-flatten_a" class="anchor"></a><code><span class="keyword">val</span> flatten_a : <span><span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> array</span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> array</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generate an array of elements from individual generators.</p><p>Shrinks on the elements of the array, in the array order.</p><dl><dt>since</dt><dd>0.13</dd></dl></dd></dl><dl><dt class="spec value" id="val-flatten_opt"><a href="#val-flatten_opt" class="anchor"></a><code><span class="keyword">val</span> flatten_opt : <span><span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> option</span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> option</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generate an option from an optional generator.</p><p>Shrinks towards <code>None</code> then shrinks on the value.</p><dl><dt>since</dt><dd>0.13</dd></dl></dd></dl><dl><dt class="spec value" id="val-flatten_res"><a href="#val-flatten_res" class="anchor"></a><code><span class="keyword">val</span> flatten_res : <span><span>(<span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span>, <span class="type-var">'e</span>)</span> Stdlib.result</span> <span>&#45;&gt;</span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'e</span>)</span> Stdlib.result</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Generate a result from <code>Ok gen</code>, an error from <code>Error e</code>.</p><p>Shrinks on <code>gen</code> if <code>Ok gen</code>. Does not shrink if <code>Error e</code>.</p><dl><dt>since</dt><dd>0.13</dd></dl></dd></dl><dl><dt class="spec value" id="val-join"><a href="#val-join" class="anchor"></a><code><span class="keyword">val</span> join : <span><span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Collapses a generator of generators to a generator.</p><p>Shrinks on the generated generators.</p><dl><dt>since</dt><dd>0.5</dd></dl></dd></dl></section><section><header><h4 id="influencing-the-size-of-generated-values"><a href="#influencing-the-size-of-generated-values" class="anchor"></a>Influencing the size of generated values</h4></header><dl><dt class="spec value" id="val-sized"><a href="#val-sized" class="anchor"></a><code><span class="keyword">val</span> sized : <span><span class="type-var">'a</span> <a href="index.html#type-sized">sized</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Creates a generator from a size-bounded generator by first generating a size using <a href="index.html#val-nat"><code>nat</code></a> and passing the result to the size-bounded generator.</p><p>Shrinks on the size first, then on the generator.</p></dd></dl><dl><dt class="spec value" id="val-sized_size"><a href="#val-sized_size" class="anchor"></a><code><span class="keyword">val</span> sized_size : <span>int <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-sized">sized</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Creates a generator from a size-bounded generator by first generating a size using the integer generator and passing the result to the size-bounded generator.</p><p>Shrinks on the size first, then on the generator.</p><dl><dt>since</dt><dd>0.5</dd></dl></dd></dl></section><section><header><h4 id="recursive-data-structures"><a href="#recursive-data-structures" class="anchor"></a>Recursive data structures</h4></header><dl><dt class="spec value" id="val-fix"><a href="#val-fix" class="anchor"></a><code><span class="keyword">val</span> fix : <span>(<span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span>)</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span>)</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Parametrized fixpoint combinator for generating recursive values.</p><p>The fixpoint is parametrized over an generator state <code>'a</code>, and the fixpoint computation may change the value of this state in the recursive calls.</p><p>In particular, this can be used for size-bounded generators (with <code>'a</code> as <code>int</code>). The passed size-parameter should decrease to ensure termination.</p></dd></dl><aside><p>Example:</p><pre><code class="ml">type tree = Leaf of int | Node of tree * tree

let leaf x = Leaf x
let node x y = Node (x,y)

let g = QCheck.Gen.(sized @@ fix
                      (fun self n -&gt; match n with
                         | 0 -&gt; map leaf nat
                         | n -&gt;
                           frequency
                             [1, map leaf nat;
                              2, map2 node (self (n/2)) (self (n/2))]
                      ))</code></pre><p><code>fix f</code> shrinks on the generators returned by <code>f</code>.</p></aside><dl><dt class="spec value" id="val-delay"><a href="#val-delay" class="anchor"></a><code><span class="keyword">val</span> delay : <span>(unit <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Delay execution of some code until the generator is actually called. This can be used to manually implement recursion or control flow in a generator.</p><dl><dt>since</dt><dd>0.17</dd></dl></dd></dl></section><section><header><h3 id="composing_generators"><a href="#composing_generators" class="anchor"></a>Composing generators</h3><p>QCheck generators compose well: it means one can easily craft generators for new values or types from existing generators.</p><p>Part of the following documentation is greatly inspired by Gabriel Scherer's excellent <a href="http://gasche.github.io/random-generator/doc/Generator.html">Generator</a> module documentation.</p></header><section><header><h4 id="functor"><a href="#functor" class="anchor"></a>Functor</h4><p><code>Gen.t</code> is a functor (in the Haskell sense of &quot;mappable&quot;): it has a <code>map</code> function to transform a generator of <code>'a</code> into a generator of <code>'b</code>, given a simple function <code>'a -&gt; 'b</code>.</p><pre><code class="ml">let even_gen : int Gen.t = Gen.map (fun n -&gt; n * 2) Gen.int

let odd_gen : int Gen.t = Gen.map (fun n -&gt; n * 2 + 1) Gen.int

let lower_case_string_gen : string Gen.t = Gen.map String.lowercase Gen.string_printable

type foo = Foo of string * int
let foo_gen : foo Gen.t =
  Gen.map (fun (s, n) -&gt; Foo (s, n)) Gen.(pair string_printable int)</code></pre></header></section><section><header><h4 id="applicative"><a href="#applicative" class="anchor"></a>Applicative</h4><p><code>Gen.t</code> is applicative: it has a <code>map2</code> function to apply a function of 2 (or more) arguments to 2 (or more) generators.</p><p>Another equivalent way to look at it is that it has an <code>ap</code> function to apply a generator of functions to a generator of values. While at first sight this may look almost useless, it actually permits a nice syntax (using the operator alias <code>&lt;*&gt;</code>) for functions of any number of arguments.</p><pre><code class="ml">(* Notice that this looks suspiciously like the [foo] example above:
   this is no coincidence! [pair] is a special case of [map2] where
   the function wraps arguments in a tuple. *)
type foo = Foo of string * int
let foo_gen : foo Gen.t =
  Gen.map2 (fun s n -&gt; Foo (s, n)) Gen.string_printable Gen.int

let string_prefixed_with_keyword_gen : string Gen.t =
  Gen.map2 (fun prefix s -&gt; prefix ^ s)
    (Gen.oneofl [&quot;foo&quot;; &quot;bar&quot;; &quot;baz&quot;])
    Gen.string_printable</code></pre><p>Applicatives are useful when you need several random values to build a new generator, <b>and the values are unrelated</b>. A good rule of thumb is: if the values could be generated in parallel, then you can use an applicative function to combine those generators.</p><p>Note that while <code>map2</code> and <code>map3</code> are provided, you can use functions with more than 3 arguments (and that is where the <code>&lt;*&gt;</code> operator alias really shines):</p><pre><code class="ml">val complex_function : bool -&gt; string -&gt; int -&gt; string -&gt; int64 -&gt; some_big_type

(* Verbose version, using map3 and ap *)
let big_type_gen : some_big_type Gen.t = Gen.(
    ap (
      ap (
        map3 complex_function
          bool
          string_printable
          int)
        string_printable)
      int64)

(* Sleeker syntax, using operators aliases for map and ap *)
let big_type_gen : some_big_type Gen.t = Gen.(
    complex_function
    &lt;$&gt; bool
    &lt;*&gt; string_printable
    &lt;*&gt; int
    &lt;*&gt; string_printable
    &lt;*&gt; int64)</code></pre></header></section><section><header><h4 id="monad"><a href="#monad" class="anchor"></a>Monad</h4><p><code>Gen.t</code> is a monad: it has a <code>bind</code> function to return a <b>generator</b> (not a value) based on <b>another generated value</b>.</p><p>As an example, imagine you want to create a generator of <code>(int, string) result</code> that is an <code>Ok</code> 90% of the time and an <code>Error</code> 10% of the time. You can generate a number between 0 and 9 and return a generator of <code>int</code> (wrapped in an <code>Ok</code> using <code>map</code>) if the generated number is lower than 9, otherwise return a generator of <code>string</code> (wrapped in an <code>Error</code> using <code>map</code>):</p><pre><code class="ml">let int_string_result : (int, string) result Gen.t = Gen.(
    bind (int_range 0 9) (fun n -&gt;
        if n &lt; 9
        then map Result.ok int
        else map Result.error string_printable))

(* Alternative syntax with operators *)
let int_string_result : (int, string) result Gen.t = Gen.(
    int_range 0 9 &gt;&gt;= fun n -&gt;
    if n &lt; 9
    then int &gt;|= Result.ok
    else string_printable &gt;|= Result.error)

(* Another allternative syntax with OCaml 4.08+ binding operators *)
let int_string_result : (int, string) result Gen.t = Gen.(
    let* n = int_range 0 9 in
    if n &lt; 9
    then int &gt;|= Result.ok
    else string_printable &gt;|= Result.error)</code></pre><p>Note that this particular use case can be simplified by using <code>frequency</code>:</p><pre><code class="ml">let int_string_result : (int, string) result Gen.t = Gen.(
    frequency [
      (9, int &gt;|= Result.ok);
      (1, string_printable &gt;|= Result.error)
    ])</code></pre></header><dl><dt class="spec value" id="val-map"><a href="#val-map" class="anchor"></a><code><span class="keyword">val</span> map : <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>map f gen</code> transforms a generator <code>gen</code> by applying <code>f</code> to each generated element.</p><p>Shrinks towards the shrinks of <code>gen</code> with <code>f</code> applied to them.</p></dd></dl><dl><dt class="spec value" id="val-(&gt;|=)"><a href="#val-(&gt;|=)" class="anchor"></a><code><span class="keyword">val</span> (&gt;|=) : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>An infix synonym for <a href="index.html#val-map"><code>map</code></a>. Note the order of arguments is reversed (usually more convenient for composing).</p></dd></dl><dl><dt class="spec value" id="val-(&lt;$&gt;)"><a href="#val-(&lt;$&gt;)" class="anchor"></a><code><span class="keyword">val</span> (&lt;$&gt;) : <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>An infix synonym for <a href="index.html#val-map"><code>map</code></a></p><dl><dt>since</dt><dd>0.13</dd></dl></dd></dl><dl><dt class="spec value" id="val-map2"><a href="#val-map2" class="anchor"></a><code><span class="keyword">val</span> map2 : <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'c</span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'c</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>map2 f gen1 gen2</code> transforms two generators <code>gen1</code> and <code>gen2</code> by applying <code>f</code> to each pair of generated elements.</p><p>Shrinks on <code>gen1</code> and then <code>gen2</code>.</p></dd></dl><dl><dt class="spec value" id="val-map3"><a href="#val-map3" class="anchor"></a><code><span class="keyword">val</span> map3 : <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'c</span> <span>&#45;&gt;</span> <span class="type-var">'d</span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'c</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'d</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>map3 f gen1 gen2 gen3</code> transforms three generators <code>gen1</code>, <code>gen2</code>, and <code>gen3</code> by applying <code>f</code> to each triple of generated elements.</p><p>Shrinks on <code>gen1</code>, then <code>gen2</code>, and then <code>gen3</code>.</p></dd></dl><dl><dt class="spec value" id="val-ap"><a href="#val-ap" class="anchor"></a><code><span class="keyword">val</span> ap : <span><span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>ap fgen gen</code> composes a function generator and an argument generator into a result generator.</p><p>Shrinks on <code>fgen</code> and then <code>gen</code>.</p></dd></dl><dl><dt class="spec value" id="val-(&lt;*&gt;)"><a href="#val-(&lt;*&gt;)" class="anchor"></a><code><span class="keyword">val</span> (&lt;*&gt;) : <span><span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Synonym for <a href="index.html#val-ap"><code>ap</code></a></p></dd></dl><dl><dt class="spec value" id="val-bind"><a href="#val-bind" class="anchor"></a><code><span class="keyword">val</span> bind : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>bind gen f</code> first generates a value of type <code>'a</code> with <code>gen</code> and then passes it to <code>f</code> to generate a value of type <code>'b</code>. This is typically useful when a generator depends on the value generated by another generator.</p><p>Shrinks on <code>gen</code> and then on the resulting generator.</p></dd></dl><dl><dt class="spec value" id="val-(&gt;&gt;=)"><a href="#val-(&gt;&gt;=)" class="anchor"></a><code><span class="keyword">val</span> (&gt;&gt;=) : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Synonym for <a href="index.html#val-bind"><code>bind</code></a></p></dd></dl><dl><dt class="spec value" id="val-let+"><a href="#val-let+" class="anchor"></a><code><span class="keyword">val</span> let+ : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><a href="https://ocaml.org/manual/bindingops.html">Binding operator</a> alias for <a href="index.html#val-map"><code>map</code></a>.</p><p>Example:</p><pre><code class="ml">let+ n = int_range 0 10 in
string_of_int n

(* is equivalent to *)

map (fun n -&gt; string_of_int n) (int_range 0 10)</code></pre></dd></dl><dl><dt class="spec value" id="val-and+"><a href="#val-and+" class="anchor"></a><code><span class="keyword">val</span> and+ : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span>)</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><a href="https://ocaml.org/manual/bindingops.html">Binding operator</a> alias for <a href="index.html#val-pair"><code>pair</code></a>.</p><p>Example:</p><pre><code class="ml">let+ n = int_range 0 10
and+ b = bool in
if b then string_of_int n else &quot;Not a number&quot;

(* is equivalent to *)

map
  (fun (n, b) -&gt; if b then string_of_int n else &quot;Not a number&quot;)
  (pair (int_range 0 10) bool)</code></pre></dd></dl><dl><dt class="spec value" id="val-let*"><a href="#val-let*" class="anchor"></a><code><span class="keyword">val</span> let* : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><a href="https://ocaml.org/manual/bindingops.html">Binding operator</a> alias for <a href="index.html#val-bind"><code>bind</code></a>.</p><p>Example:</p><pre><code class="ml">let* n = int_range 0 9 in
if n &lt; 9
then int &gt;|= Result.ok
else string_printable &gt;|= Result.error

(* is equivalent to *)

bind (int_range 0 9) (fun n -&gt;
    if n &lt; 9
    then map Result.ok int
    else map Result.error string_printable)</code></pre></dd></dl><dl><dt class="spec value" id="val-and*"><a href="#val-and*" class="anchor"></a><code><span class="keyword">val</span> and* : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span>)</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><a href="https://ocaml.org/manual/bindingops.html">Binding operator</a> alias for <a href="index.html#val-pair"><code>pair</code></a>.</p><p>Example:</p><pre><code class="ml">let* n = int_range 0 9
and* b = bool in
if n &lt; 9 then int &gt;|= Result.ok
else if b then pure (Error &quot;Some specific error&quot;)
else string_printable &gt;|= Result.error

(* is equivalent to *)

bind (pair (int_range 0 9) bool) (fun (n, b) -&gt;
    if n &lt; 9 then map Result.ok int
    else if b then pure (Error &quot;Some specific error&quot;)
    else map Result.error string_printable)</code></pre></dd></dl></section></section><section><header><h3 id="debug-generators"><a href="#debug-generators" class="anchor"></a>Debug generators</h3><p>These functions should not be used in tests: they are provided for convenience to debug/investigate what values and shrinks a generator produces.</p></header><dl><dt class="spec value" id="val-generate"><a href="#val-generate" class="anchor"></a><code><span class="keyword">val</span> generate : <span>?&#8288;rand:Stdlib.Random.State.t</span> <span>&#45;&gt;</span> <span>n:int</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> list</span></code></dt><dd><p><code>generate ~n gen</code> generates <code>n</code> values using <code>gen</code> (shrinks are discarded).</p></dd></dl><dl><dt class="spec value" id="val-generate1"><a href="#val-generate1" class="anchor"></a><code><span class="keyword">val</span> generate1 : <span>?&#8288;rand:Stdlib.Random.State.t</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>generate1 gen</code> generates one instance of <code>gen</code> (shrinks are discarded).</p></dd></dl><dl><dt class="spec value" id="val-generate_tree"><a href="#val-generate_tree" class="anchor"></a><code><span class="keyword">val</span> generate_tree : <span>?&#8288;rand:Stdlib.Random.State.t</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="../Tree/index.html#type-t">Tree.t</a></span></code></dt><dd><p><code>generate_tree ?rand gen</code> generates a random value and its shrinks using <code>gen</code>.</p></dd></dl></section></div></body></html>