<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>QCheck_base_runner (qcheck-core.QCheck_base_runner)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">qcheck-core</a> &#x00BB; QCheck_base_runner</nav><h1>Module <code>QCheck_base_runner</code></h1><h2 id="runners-for-tests"><a href="#runners-for-tests" class="anchor"></a>Runners for Tests</h2><p>Once you built some tests using <a href="../QCheck2/Test/index.html#val-make"><code>QCheck2.Test.make</code></a>, you need to run the tests. This module contains several <b>runners</b>, which are designed to run every test and report the result.</p><p>By default, you can use <a href="index.html#val-run_tests"><code>run_tests</code></a> in a test program as follows:</p><pre><code class="ml">let testsuite = [
  Test.make ...;
  Test.make ...;
]

let () =
  let errcode = QCheck_base_runner.run_tests ~verbose:true testsuite in
  exit errcode</code></pre><p>which will run the tests, and exit the program. The error code will be 0 if all tests pass, 1 otherwise.</p><p><a href="index.html#val-run_tests_main"><code>run_tests_main</code></a> can be used as a shortcut for that, also featuring command-line parsing (using <code>Arg</code>) to activate verbose mode and others.</p><nav class="toc"><ul><li><a href="#state">State</a></li><li><a href="#event-handlers">Event handlers</a></li><li><a href="#run-a-suite-of-tests-and-get-results">Run a Suite of Tests and Get Results</a></li></ul></nav></header><section><header><h3 id="state"><a href="#state" class="anchor"></a>State</h3></header><dl><dt class="spec value" id="val-random_state"><a href="#val-random_state" class="anchor"></a><code><span class="keyword">val</span> random_state : unit <span>&#45;&gt;</span> Stdlib.Random.State.t</code></dt><dd><p>Access the current random state</p></dd></dl><dl><dt class="spec value" id="val-verbose"><a href="#val-verbose" class="anchor"></a><code><span class="keyword">val</span> verbose : unit <span>&#45;&gt;</span> bool</code></dt><dd><p>Is the default mode verbose or quiet?</p></dd></dl><dl><dt class="spec value" id="val-long_tests"><a href="#val-long_tests" class="anchor"></a><code><span class="keyword">val</span> long_tests : unit <span>&#45;&gt;</span> bool</code></dt><dd><p>Is the default mode to run long tests or nor?</p></dd></dl><dl><dt class="spec value" id="val-set_seed"><a href="#val-set_seed" class="anchor"></a><code><span class="keyword">val</span> set_seed : int <span>&#45;&gt;</span> unit</code></dt><dd><p>Change the <a href="index.html#val-random_state"><code>random_state</code></a> by creating a new one, initialized with the given seed.</p></dd></dl><dl><dt class="spec value" id="val-set_verbose"><a href="#val-set_verbose" class="anchor"></a><code><span class="keyword">val</span> set_verbose : bool <span>&#45;&gt;</span> unit</code></dt><dd><p>Change the value of <code>verbose ()</code></p></dd></dl><dl><dt class="spec value" id="val-set_long_tests"><a href="#val-set_long_tests" class="anchor"></a><code><span class="keyword">val</span> set_long_tests : bool <span>&#45;&gt;</span> unit</code></dt><dd><p>Change the value of <code>long_tests ()</code></p></dd></dl><dl><dt class="spec value" id="val-get_time_between_msg"><a href="#val-get_time_between_msg" class="anchor"></a><code><span class="keyword">val</span> get_time_between_msg : unit <span>&#45;&gt;</span> float</code></dt><dd><p>Get the minimum time to wait between printing messages.</p><dl><dt>since</dt><dd>0.9</dd></dl></dd></dl><dl><dt class="spec value" id="val-set_time_between_msg"><a href="#val-set_time_between_msg" class="anchor"></a><code><span class="keyword">val</span> set_time_between_msg : float <span>&#45;&gt;</span> unit</code></dt><dd><p>Set the minimum tiem between messages.</p><dl><dt>since</dt><dd>0.9</dd></dl></dd></dl></section><section><header><h3 id="event-handlers"><a href="#event-handlers" class="anchor"></a>Event handlers</h3></header><dl><dt class="spec type" id="type-counter"><a href="#type-counter" class="anchor"></a><code><span class="keyword">type</span> counter</code><code> = <span class="keyword">private</span> </code><code>{</code><table class="record"><tr id="type-counter.start" class="anchored"><td class="def field"><a href="#type-counter.start" class="anchor"></a><code>start : float;</code></td></tr><tr id="type-counter.expected" class="anchored"><td class="def field"><a href="#type-counter.expected" class="anchor"></a><code>expected : int;</code></td></tr><tr id="type-counter.gen" class="anchored"><td class="def field"><a href="#type-counter.gen" class="anchor"></a><code><span class="keyword">mutable</span> gen : int;</code></td></tr><tr id="type-counter.passed" class="anchored"><td class="def field"><a href="#type-counter.passed" class="anchor"></a><code><span class="keyword">mutable</span> passed : int;</code></td></tr><tr id="type-counter.failed" class="anchored"><td class="def field"><a href="#type-counter.failed" class="anchor"></a><code><span class="keyword">mutable</span> failed : int;</code></td></tr><tr id="type-counter.errored" class="anchored"><td class="def field"><a href="#type-counter.errored" class="anchor"></a><code><span class="keyword">mutable</span> errored : int;</code></td></tr></table><code>}</code></dt><dd><p>The type of counter used to keep tracks of the events received for a given test cell.</p></dd></dl><dl><dt class="spec type" id="type-handler"><a href="#type-handler" class="anchor"></a><code><span class="keyword">type</span> handler</code><code> = </code><code>{</code><table class="record"><tr id="type-handler.handler" class="anchored"><td class="def field"><a href="#type-handler.handler" class="anchor"></a><code>handler : a. <span><span class="type-var">'a</span> <a href="../QCheck2/Test/index.html#type-handler">QCheck2.Test.handler</a></span>;</code></td></tr></table><code>}</code></dt><dd><p>A type to represent polymorphic-enough handlers for test cells.</p></dd></dl><dl><dt class="spec type" id="type-handler_gen"><a href="#type-handler_gen" class="anchor"></a><code><span class="keyword">type</span> handler_gen</code><code> = <span>colors:bool</span> <span>&#45;&gt;</span> <span>debug_shrink:<span>Stdlib.out_channel option</span></span> <span>&#45;&gt;</span> <span>debug_shrink_list:<span>string list</span></span> <span>&#45;&gt;</span> <span>size:int</span> <span>&#45;&gt;</span> <span>out:Stdlib.out_channel</span> <span>&#45;&gt;</span> <span>verbose:bool</span> <span>&#45;&gt;</span> <a href="index.html#type-counter">counter</a> <span>&#45;&gt;</span> <a href="index.html#type-handler">handler</a></code></dt><dd><p>An alias type to a generator of handlers for test cells.</p></dd></dl><dl><dt class="spec value" id="val-default_handler"><a href="#val-default_handler" class="anchor"></a><code><span class="keyword">val</span> default_handler : <a href="index.html#type-handler_gen">handler_gen</a></code></dt><dd><p>The default handler used.</p></dd></dl></section><section><header><h3 id="run-a-suite-of-tests-and-get-results"><a href="#run-a-suite-of-tests-and-get-results" class="anchor"></a>Run a Suite of Tests and Get Results</h3></header><dl><dt class="spec value" id="val-run_tests"><a href="#val-run_tests" class="anchor"></a><code><span class="keyword">val</span> run_tests : <span>?&#8288;handler:<a href="index.html#type-handler_gen">handler_gen</a></span> <span>&#45;&gt;</span> <span>?&#8288;colors:bool</span> <span>&#45;&gt;</span> <span>?&#8288;verbose:bool</span> <span>&#45;&gt;</span> <span>?&#8288;long:bool</span> <span>&#45;&gt;</span> <span>?&#8288;debug_shrink:<span>Stdlib.out_channel option</span></span> <span>&#45;&gt;</span> <span>?&#8288;debug_shrink_list:<span>string list</span></span> <span>&#45;&gt;</span> <span>?&#8288;out:Stdlib.out_channel</span> <span>&#45;&gt;</span> <span>?&#8288;rand:Stdlib.Random.State.t</span> <span>&#45;&gt;</span> <span><a href="../QCheck2/Test/index.html#type-t">QCheck2.Test.t</a> list</span> <span>&#45;&gt;</span> int</code></dt><dd><p>Run a suite of tests, and print its results. This is an heritage from the &quot;qcheck&quot; library.</p><dl><dt>returns</dt><dd><p>an error code, <code>0</code> if all tests passed, <code>1</code> otherwise.</p></dd></dl><dl><dt>parameter colors</dt><dd><p>if true, colorful output</p></dd></dl><dl><dt>parameter verbose</dt><dd><p>if true, prints more information about test cases</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-run_tests_main"><a href="#val-run_tests_main" class="anchor"></a><code><span class="keyword">val</span> run_tests_main : <span>?&#8288;argv:<span>string array</span></span> <span>&#45;&gt;</span> <span><a href="../QCheck2/Test/index.html#type-t">QCheck2.Test.t</a> list</span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Can be used as the main function of a test file. Exits with a non-0 code if the tests fail. It refers to <a href="index.html#val-run_tests"><code>run_tests</code></a> for actually running tests after CLI options have been parsed.</p><p>The available options are:</p><ul><li>&quot;--verbose&quot; (or &quot;-v&quot;) for activating verbose tests</li><li>&quot;--seed &lt;n&gt;&quot; (or &quot;-s &lt;n&gt;&quot;) for repeating a previous run by setting the random seed</li><li>&quot;--long&quot; for running the long versions of the tests</li></ul><p>Below is an example of the output of the <code>run_tests</code> and <code>run_tests_main</code> function:</p><pre>random seed: 438308050
generated  error;  fail; pass / total -     time -- test name
[✓] (1000)    0 ;    0 ; 1000 / 1000 --     0.5s -- list_rev_is_involutive
[✗] (   1)    0 ;    1 ;    0 /   10 --     0.0s -- should_fail_sort_id
[✗] (   1)    1 ;    0 ;    0 /   10 --     0.0s -- should_error_raise_exn
[✓] (1000)    0 ;    0 ; 1000 / 1000 --     0.0s -- collect_results

--- Failure --------------------------------------------------------------------

Test should_fail_sort_id failed (11 shrink steps):

[1; 0]

=== Error ======================================================================

Test should_error_raise_exn errored on (62 shrink steps):

0

exception QCheck_runner_test.Error
Raised at file &quot;example/QCheck_runner_test.ml&quot;, line 20, characters 20-25
Called from file &quot;src/QCheck.ml&quot;, line 839, characters 13-33


+++ Collect ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Collect results for test collect_results:

4: 207 cases
3: 190 cases
2: 219 cases
1: 196 cases
0: 188 cases

================================================================================
failure (1 tests failed, 1 tests errored, ran 4 tests)</pre></dd></dl><dl><dt class="spec module" id="module-Color"><a href="#module-Color" class="anchor"></a><code><span class="keyword">module</span> <a href="Color/index.html">Color</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd></dd></dl><dl><dt class="spec module" id="module-Raw"><a href="#module-Raw" class="anchor"></a><code><span class="keyword">module</span> <a href="Raw/index.html">Raw</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd></dd></dl></section></div></body></html>